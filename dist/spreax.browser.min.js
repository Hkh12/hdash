var Spreax=function(){function e(t){for(var r=[],n=Node.TEXT_NODE,o=Node.ELEMENT_NODE,i=0,a=t.childNodes;i<a.length;i+=1){var s=a[i];if(/\S+/g.test(s.textContent)){var u=s.nodeType;if(u===n)r.push(s);else{if(u!==o)continue;r=r.concat(e(s))}}}return r}function t(e){return e.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})}function r(e){for(var r,n=e.attributes,o=[],i=function(){var e=s[a].name;if(/^sp-/.test(e)){var n=(e=e.replace(/^sp-/,"")).match(/^([a-z]+(?:-[a-z]+)*)(:[a-z0-9]+(?:-[a-z0-9]+)*)?((?:\.[a-z0-9]+))*$/),i=n[1],u=n[2],c=n[3];u&&(u=u.replace(/^:/,""));var f,d,l,p={name:i,arg:u||null,modifiers:c?(f=c.slice(1).split(".").map(t),d=!0,l={},f.forEach(function(e){l[e]=d}),l):{}};o.push(Object.assign({},p,((r={})[Symbol.toPrimitive]=function(e){return"number"===e?NaN:function(e){var t="sp-"+e.name;e.arg&&(t+=":"+e.arg);var r=Object.keys(e.modifiers);return r.length&&(t+="."+r.join(".")),t}(p)},r)))}},a=0,s=n;a<s.length;a+=1)i();return o.filter(function(e,t,r){var n=function(e){return e.arg?[e.name,e.arg].join(":"):e.name},o=r.filter(function(t){return n(t)===n(e)});return o.length>1?o[0]:e})}var n=function(e){function t(t,r){e.call(this,t+"\nat: "+function(e,t){void 0===t&&(t="body"),"string"==typeof t&&(t=document.querySelector(t));for(var r=[];e!==t;)r.unshift(e),e=e.parentElement;return r.unshift(t),r.map(function(e){var t=e.tagName.toLowerCase();return e.className&&(t+="."+e.className.trim().split(" ").join(".")),e.id&&(t+="#"+e.id),t=t.replace(/^div([^$]+)/,"$1")}).join(" > ")}(r))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),o={};function i(e,t,r){if(void 0===r&&(r=!1),e in o)throw new Error('directive "'+e+'" already exists');if(!/^[a-z]+(?:-[a-z]+)*$/.test(e))throw new Error('"'+e+'" is not a valid directive name');o[e]={argRequired:r,callback:t}}var a={null:null,"!0":!0,"!1":!1,false:!1,true:!0,undefined:void 0};var s=[];i("on",function(e){var t,r=this,n=e.element,o=e.attributeValue,i=e.modifiers,u=e.argument;if(t=u,0===s.length&&(s=Object.keys(window).filter(function(e){return/^on/.test(e)}).map(function(e){return e.replace(/^on/,"")})),!s.includes(t))throw new TypeError('event "'+u+'" is not a valid DOM event.');var c=/ = .+$/.test(o);n.addEventListener(u,function(e){if(i.prevent&&e.preventDefault(),c){var t=function(e){var t=e.match(/^(.+) = (.+)$/);if(null===t)throw new SyntaxError('string "'+e+'" is not a valid assignment statement');var r=t[1],n=t[2],o=!1;if(n in a)n=a[n];else if(isNaN(+n))if(/^(['"`]).*\1$/.test(n))n=n.slice(1,-1);else{if(!/^!?\w+$/i.test(n))throw new SyntaxError('could not find any values matching "'+n+'"');o=!0}else n=Number(n);return{prop:r,getValue:function(e){return o?n.startsWith("!")?!e[n.slice(1)]:e[n]:n}}}(o);r[t.prop]=t.getValue(r)}else r[o]()},{once:i.once,passive:i.passive,capture:i.capture})},!0),i("model",{ready:function(e){var t=this,r=e.element,o=e.attributeValue,i=e.modifiers.lazy;if(!["select","input","textarea"].includes(r.tagName.toLowerCase()))throw new n("model directive only works on input, textarea or select tags",r);"checkbox"===r.type?r.checked=!!this[o]:r.value=this[o],r.addEventListener("change",function(){t[o]="checkbox"===r.type?r.checked:r.value}),"text"!==r.type||i||r.addEventListener("keydown",function(){setTimeout(function(){t[o]=r.value},0)})},updated:function(e){var t=e.element,r=e.attributeValue;t["checkbox"===t.type?"checked":"value"]=this[r]}}),i("class",function(e){var t=e.element,r=e.argument,n=e.attributeValue;this.$onUpdate(function(e){t.classList[e?"add":"remove"](r||n);var o=t.getAttribute("class");null===o||o.length||t.removeAttribute("class")},{immediate:!0,ownerNode:t,prop:n||r})},!0),i("style",function(e){var r=e.element,n=e.argument,o=e.attributeValue;n=t(n);var i="opacity, z-index, font-weight, line-height".split(", ");this.$onUpdate(function(e){isNaN(+e)||i.includes(n)||(e+="px"),r.style[n]=e},{ownerNode:r,immediate:!0,prop:o||n})},!0);var u=function(t,r){var n=this;if("string"==typeof t)this.$el=document.querySelector(t);else{if(!(t instanceof HTMLElement))throw new TypeError('wrong selector or element: expected element or string, got "'+String(t)+'"');this.$el=t}this.$events=[],this.$formatters={},this.$makeProxy(r.state),function(e,t){var r=t.state;void 0===r&&(r={});var n=t.actions;void 0===n&&(n={});var o=t.computed;void 0===o&&(o={});var i=t.formatters;void 0===i&&(i={});var a=Object.defineProperty,s=function(t){a(e,t,{get:function(){return e.$proxy[t]},set:function(r){e.$proxy[t]=r},configurable:!1,enumerable:!1})};for(var u in r)s(u);for(var c in n)e[c]=n[c].bind(e);for(var f in o)a(e,f,{get:o[f].bind(e),set:function(){return!1},configurable:!1});for(var d in i)e.$formatters[d]=i[d].bind(e)}(this,{state:r.state,actions:r.actions,computed:r.computed,formatters:r.formatters}),e(this.$el).forEach(this.$processTemplate,this),this.$el.querySelectorAll("*").forEach(this.$execDirectives,this),this.$observe(),this.$diffProp=null,this.$diffPropValue=void 0;var o=r.watch||{},i=function(e){n.$onUpdate(function(t){o[e].call(n,t,n.$diffPropValue)},{prop:e})};for(var a in o)i(a)};return u.prototype.$makeProxy=function(e){var t,r=this;void 0===e&&(e={}),this.$proxy=(t={beforeSet:function(e,t){r.$diffProp=t,r.$diffPropValue=e[t]},setted:function(){return r.$update()}},new Proxy(e,{get:function(e,t){if(!e.hasOwnProperty(t))throw new Error('unknown state property "'+t+'"');return e[t]},deleteProperty:function(){return!1},set:function(e,r,n){if(!e.hasOwnProperty(r))throw new Error('unknown state property "'+r+'"');return e[r]!==n&&(t.beforeSet(e,r),e[r]=n,t.setted(e,r),!0)}}))},u.prototype.$pipeFormatters=function(e){return function(e,t){return e.length?e.map(function(e){if(t.hasOwnProperty(e))return t[e];throw new Error('formatter "'+e+'" not found')}).reduce(function(e,t){return function(r){return t(e(r))}}):function(e){return e}}(e,this.$formatters).bind(this)},u.prototype.$execDirectives=function(e){var t=this;!function(e,t){if(e.attributes.length)for(var i=0,a=r(e);i<a.length;i+=1){var s=a[i];if(!o.hasOwnProperty(s.name))throw new n('directive "'+s.name+'" not found',e);var u=o[s.name],c=u.argRequired,f=u.callback;if(c&&!s.arg)throw new n("directive needs an arguments, but there's nothing",e);t(f,{element:e,attributeValue:e.getAttribute(""+s),modifiers:s.modifiers,argument:s.arg})}}(e,function(r,n){"function"==typeof r?r.call(t,n):("ready"in r&&r.ready.call(t,n),"updated"in r&&t.$onUpdate(function(){r.updated.call(t,n)},{ownerNode:e}))})},u.prototype.$processTemplate=function(e){var t=this,r=/#\[\w+(?: \w+)*\]/g,n=e.textContent;if(r.test(n)){var o=function(e){return n.replace(r,function(r){var n=r.slice(2,-1).split(" "),o=n[0],i=n.slice(1);return t.$pipeFormatters(i)(e[o])})};this.$onUpdate(function(){var r,n=o(Object.assign({},t.$proxy,((r={})[t.$diffProp]=t.$diffPropValue,r))),i=o(t);(!t.$diffProp||n!==i)&&(e.textContent=i)},{immediate:!0,ownerNode:e})}},u.prototype.$observe=function(){var t,r,n,o=this,i=function(e){for(var t=o.$events.filter(function(t){return t.ownerNode===e}).map(function(e,t){return t}),r=0,n=t;r<n.length;r+=1){var i=n[r];o.$events.splice(i,1)}};(t={textAdded:this.$processTemplate.bind(this),elementAdded:this.$execDirectives.bind(this),textRemoved:i,elementRemoved:i},r=Node.TEXT_NODE,n=Node.ELEMENT_NODE,new MutationObserver(function(o){for(var i=0,a=o;i<a.length;i+=1){for(var s=a[i],u=0,c=s.addedNodes;u<c.length;u+=1){var f=c[u];if(f.nodeType===r){if("childList"===s.type&&s.target.hasChildNodes(f))continue;t.textAdded(f)}else f.nodeType===n&&(e(f).forEach(function(e){return t.textAdded(e)}),t.elementAdded(f))}for(var d=0,l=s.removedNodes;d<l.length;d+=1){var p=l[d];p.nodeType===r?t.textRemoved(p):p.nodeType===n&&(e(p).forEach(function(e){return t.textRemoved(e)}),t.elementRemoved(p))}}})).observe(this.$el,{childList:!0,subtree:!0})},u.prototype.$onUpdate=function(e,t){var r=t.prop;void 0===r&&(r="");var n=t.ownerNode,o=t.immediate;void 0===o&&(o=!1);var i=(1e6*Math.random()>>0).toString().padEnd(6,"0");this.$events.push(Object.assign({},{prop:r,fn:e,id:i},n?{ownerNode:n}:{})),o&&this.$update(i)},u.prototype.$update=function(e){var t=this;this.$events.filter(function(r){return e?r.id===e:!r.prop||r.prop===t.$diffProp}).forEach(function(e){var r=e.prop;e.fn.call(t,t[r])})},u.directive=i,u}();
