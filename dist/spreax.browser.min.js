var Spreax=function(){var e={};function t(t,n,r){if(void 0===r&&(r=!1),t in e)throw new Error('directive "'+t+'" already exists');if(!/^[a-z]+(?:-[a-z]+)*$/.test(t))throw new Error('"'+t+'" is not a valid directive name');e[t]={argumentIsRequired:r,callback:n}}var n=e,r={null:null,"!0":!0,"!1":!1,false:!1,true:!0,undefined:void 0};t("on",function(e,t,n,i){var o=this,a=/ = .+$/.test(t);e.addEventListener(i,function(e){if(n.prevent&&e.preventDefault(),a){var i=function(e){var t=e.match(/^(.+) = (.+)$/);if(null===t)throw new SyntaxError('string "'+e+'" is not a valid assignment statement');var n=t[1],i=t[2],o=!1;if(i in r)i=r[i];else if(isNaN(Number(i)))if(/^(['"`]).*\1$/.test(i))i=i.slice(1,-1);else{if(!/^\w+$/i.test(i))throw new SyntaxError('could not find any values matching "'+i+'"');o=!0}else i=Number(i);return{prop:n,getValue:function(e){return o?e[i]:i}}}(t);o[i.prop]=i.getValue(o)}else o[t]()},{once:n.once,passive:n.passive,capture:n.capture})},!0);var i=function(e){function t(t,n){e.call(this,t),this.message=t+"\n error at: "+function(e,t){void 0===t&&(t="body"),"string"==typeof t&&(t=document.querySelector(t));for(var n=[];e!==t;)n.unshift(e),e=e.parentElement;return n.unshift(t),(n=n.map(function(e){var t=e.tagName.toLowerCase();return e.className&&(t+="."+e.className.trim().split(" ").join(".")),e.id&&(t+="#"+e.id),t=t.replace(/^div([^$]+)/,"$1")})).join(" > ")}(n)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error);function o(e){for(var t,n=e.attributes,r=[],i=function(){var e=a[o].name;if(/^sp-/.test(e)){var n=(e=e.replace(/^sp-/,"")).match(/^([a-z]+(?:-[a-z]+)*)(:[a-z0-9]+)?((?:\.[a-z0-9]+))*$/),i=n[1],s=n[2],c=n[3];s&&(s=s.replace(/^:/,""));var u,f,d,p={name:i,arg:s||null,modifiers:c?(u=c.slice(1).split("."),f=!0,d={},u.forEach(function(e){d[e]=f}),d):{}};r.push(Object.assign({},p,((t={})[Symbol.toPrimitive]=function(e){return"number"===e?NaN:function(e){var t="sp-"+e.name;e.arg&&(t+=":"+e.arg);var n=Object.keys(e.modifiers);return n.length&&(t+="."+n.join(".")),t}(p)},t)))}},o=0,a=n;o<a.length;o+=1)i();return r.filter(function(e,t,n){var r=function(e){return e.arg?[e.name,e.arg].join(":"):e.name},i=n.filter(function(t){return r(t)===r(e)});return i.length>1?i[0]:e})}function a(e){for(var t=[],n=0,r=e.childNodes;n<r.length;n+=1){var i=r[n];if(/\S+/g.test(i.textContent)){var o=i.nodeType;o===Node.TEXT_NODE?t.push(i):o===Node.ELEMENT_NODE&&(t=t.concat(a(i)))}}return t}t("model",{ready:function(e,t,n){var r=this,o=n.lazy;if(!["select","input","textarea"].includes(e.tagName.toLowerCase()))throw new i("model directive only works on input, textarea or select tags",e);"checkbox"===e.type?e.checked=!!this[t]:e.value=this[t],e.addEventListener("change",function(){r[t]="checkbox"===e.type?e.checked:e.value}),"text"!==e.type||o||e.addEventListener("keydown",function(){setTimeout(function(){r[t]=e.value},0)})},updated:function(e,t){e["checkbox"===e.type?"checked":"value"]=this[t]}}),t("class",function(e,t,n,r){var i=t||r;this.$on(i,function(n){e.classList[n?"add":"remove"](r||t);var i=e.getAttribute("class");null===i||i.length||e.removeAttribute("class")},{immediate:!0,id:e,type:"DIRECTIVE"})},!0);var s=function(e,t){if("string"==typeof e)this.$el=document.querySelector(e);else{if(!(e instanceof HTMLElement))throw new TypeError('wrong selector or element: expected element or string, got "'+String(e)+'"');this.$el=e}this.$events=[],this.$formatters={},this.$_proxy=null,this.$extendWith(t.state||{},t.actions||{},t.computed||{},t.formatters||{}),a(this.$el).forEach(this.$interpolation,this),this.$el.querySelectorAll("*").forEach(this.$execDirectives,this),this.$observe()};return s.prototype.$extendWith=function(e,t,n,r){var i=this;this.$makeProxy(e),Object.keys(e).forEach(function(e){Object.defineProperty(i,e,{get:function(){return i.$_proxy[e]},set:function(t){i.$_proxy[e]=t}})}),Object.entries(t).forEach(function(e){var t=e[0],n=e[1];i[t]=n.bind(i)}),Object.entries(n).forEach(function(e){var t=e[0],n=e[1];Object.defineProperty(i,t,{get:n.bind(i),set:function(){return!1}})}),Object.entries(r).forEach(function(e){var t=e[0],n=e[1];i.$formatters[t]=n.bind(i)})},s.prototype.$makeProxy=function(e){var t=this;this.$_proxy=new Proxy(e,{get:function(e,t){if(!e.hasOwnProperty(t))throw new Error('unknown state property "'+t+'"');return e[t]},set:function(e,n,r){if(!e.hasOwnProperty(n))throw new Error('unknown state property "'+n+'"');if(r!==e[n])return e[n]=r,t.$emit(n),t.$emit(),!0},deleteProperty:function(){return!1}})},s.prototype.$pipeFormatters=function(e){return arguments.length>1?e=Array.prototype.slice.call(arguments):1===arguments.length&&"string"==typeof e&&(e=[e]),function(e,t){return e.length?e.map(function(e){if(e in t)return t[e];throw new Error('formatter "'+e+'" not found')}).reduce(function(e,t){return function(n){return t(e(n))}}):function(e){return e}}(e,this.$formatters).bind(this)},s.prototype.$execDirectives=function(e){var t=this;if(e.attributes.length)for(var r=o(e),a=function(){var r=c[s];if(!n.hasOwnProperty(r.name))throw new i('directive "'+r.name+'" not found',e);var o=n[r.name],a=o.argumentIsRequired,u=o.callback;if(a&&!r.arg)throw new i("directive needs an arguments, but there's nothing",e);var f=e.getAttribute(""+r),d=[e,f,r.modifiers,r.arg];"function"==typeof u?u.apply(t,d):("ready"in u&&u.ready.apply(t,d),"updated"in u&&t.$on("",function(){u.updated.apply(t,d)},{type:"DIRECTIVE",node:e}))},s=0,c=r;s<c.length;s+=1)a()},s.prototype.$interpolation=function(e){var t=this;!function(e,t){var n=/#\[( ?)\w+(?: \w+)*\1\]/gi,r=e.textContent;if(n.test(r)){var i=[];r.replace(n,function(e,t,n){return i.push({string:e,startIndex:n}),e});for(var o=0,a=i;o<a.length;o+=1){var s=a[o],c=s.string,u=s.startIndex,f=c.replace(/^#\[ ?/,"").replace(/ ?\]$/,"").split(" "),d=f[0];t({initialText:r,node:e,formatters:f.slice(1),match:{startIndex:u,string:c},propertyName:d})}}}(e,function(e){var n=e.initialText,r=e.node,i=e.propertyName,o=e.formatters,a=e.match,s=a.startIndex,c=a.string,u=t.$pipeFormatters(o);t.$on(i,function(e){e=String(u(e));var t=n.slice(0,s)+e+n.slice(s+c.length+e.length,n.length);n!==t&&(r.textContent=t)},{immediate:!0,type:"INTERPOLATION",node:r})})},s.prototype.$observe=function(){var e,t,n,r=this,i=function(e,t){void 0===t&&(t="INTERPOLATION");for(var n=r.$events.filter(function(n){return n.type===t&&n.node===e}).map(function(e,t){return t}),i=0,o=n;i<o.length;i+=1){var a=o[i];r.$events.splice(a,1)}};(e={textAdded:this.$interpolation.bind(this),elementAdded:this.$execDirectives.bind(this),textRemoved:i,elementRemoved:function(e){i(e,"DIRECTIVE")}},t=Node.TEXT_NODE,n=Node.ELEMENT_NODE,new MutationObserver(function(r){for(var i=0,o=r;i<o.length;i+=1){for(var s=o[i],c=0,u=s.addedNodes;c<u.length;c+=1){var f=u[c];if(f.nodeType===t){if("childList"===s.type&&s.target.hasChildNodes(f))continue;e.textAdded(f)}else f.nodeType===n&&(a(f).forEach(function(t){return e.textAdded(t)}),e.elementAdded(f))}for(var d=0,p=s.removedNodes;d<p.length;d+=1){var l=p[d];l.nodeType===t?e.textRemoved(l):l.nodeType===n&&(a(l).forEach(function(t){return e.textRemoved(t)}),e.elementRemoved(l))}}})).observe(this.$el,{childList:!0,subtree:!0})},s.prototype.$on=function(e,t,n){void 0===n&&(n={}),this.$events.push(Object.assign({},{prop:e,fn:t},"type"in n?{type:n.type}:{},"node"in n?{node:n.node}:{})),n.immediate&&this.$emit(e)},s.prototype.$emit=function(e){var t=this;this.$events.filter(function(t){return!e||t.prop===e}).forEach(function(e){var n=e.prop?[t[e.prop]]:[];e.fn.apply(t,n)})},s.directive=t,s}();
