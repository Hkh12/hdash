var Spreax=function(){var e={};function t(t,n,r){if(void 0===r&&(r={}),t in e)throw new Error('directive "'+t+'" already exists');if(!/^[a-z]+(?:-[a-z]+)*$/.test(t))throw new Error('"'+t+'" is not a valid directive name');e[t]={options:r,callback:n}}var n=e,r={null:null,"!0":!0,"!1":!1,false:!1,true:!0,undefined:void 0};var i=[];t("on",function(e){var t,n=this,o=e.element,a=e.attributeValue,s=e.modifiers,u=e.argument;if(t=u,0===i.length&&(i=Object.keys(window).filter(function(e){return/^on/.test(e)}).map(function(e){return e.replace(/^on/,"")})),!i.includes(t))throw new TypeError('event "'+u+'" is not a valid DOM event.');var c=/ = .+$/.test(a);o.addEventListener(u,function(e){if(s.prevent&&e.preventDefault(),c){var t=function(e){var t=e.match(/^(.+) = (.+)$/);if(null===t)throw new SyntaxError('string "'+e+'" is not a valid assignment statement');var n=t[1],i=t[2],o=!1;if(i in r)i=r[i];else if(isNaN(+i))if(/^(['"`]).*\1$/.test(i))i=i.slice(1,-1);else{if(!/^!?\w+$/i.test(i))throw new SyntaxError('could not find any values matching "'+i+'"');o=!0}else i=Number(i);return{prop:n,getValue:function(e){return o?"!"===i.charAt(0)?!e[i.slice(1)]:e[i]:i}}}(a);n[t.prop]=t.getValue(n)}else n[a]()},{once:s.once,passive:s.passive,capture:s.capture})},{argumentIsRequired:!0});var o=function(e){function t(t,n){e.call(this,t),this.message=t+"\n error at: "+function(e,t){void 0===t&&(t="body"),"string"==typeof t&&(t=document.querySelector(t));for(var n=[];e!==t;)n.unshift(e),e=e.parentElement;return n.unshift(t),(n=n.map(function(e){var t=e.tagName.toLowerCase();return e.className&&(t+="."+e.className.trim().split(" ").join(".")),e.id&&(t+="#"+e.id),t=t.replace(/^div([^$]+)/,"$1")})).join(" > ")}(n)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error);function a(e){return e.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})}function s(e){for(var t=[],n=Node.TEXT_NODE,r=Node.ELEMENT_NODE,i=0,o=e.childNodes;i<o.length;i+=1){var a=o[i];if(/\S+/g.test(a.textContent)){var u=a.nodeType;if(u===n)t.push(a);else{if(u!==r)continue;t=t.concat(s(a))}}}return t}function u(e){for(var t,n=e.attributes,r=[],i=function(){var e=s[o].name;if(/^sp-/.test(e)){var n=(e=e.replace(/^sp-/,"")).match(/^([a-z]+(?:-[a-z]+)*)(:[a-z0-9]+(?:-[a-z0-9]+)*)?((?:\.[a-z0-9]+))*$/),i=n[1],u=n[2],c=n[3];u&&(u=u.replace(/^:/,""));var f,l,d,p={name:i,arg:u||null,modifiers:c?(f=c.slice(1).split(".").map(a),l=!0,d={},f.forEach(function(e){d[e]=l}),d):{}};r.push(Object.assign({},p,((t={})[Symbol.toPrimitive]=function(e){return"number"===e?NaN:function(e){var t="sp-"+e.name;e.arg&&(t+=":"+e.arg);var n=Object.keys(e.modifiers);return n.length&&(t+="."+n.join(".")),t}(p)},t)))}},o=0,s=n;o<s.length;o+=1)i();return r.filter(function(e,t,n){var r=function(e){return e.arg?[e.name,e.arg].join(":"):e.name},i=n.filter(function(t){return r(t)===r(e)});return i.length>1?i[0]:e})}t("model",{ready:function(e){var t=this,n=e.element,r=e.attributeValue,i=e.modifiers.lazy;if(!["select","input","textarea"].includes(n.tagName.toLowerCase()))throw new o("model directive only works on input, textarea or select tags",n);"checkbox"===n.type?n.checked=!!this[r]:n.value=this[r],n.addEventListener("change",function(){t[r]="checkbox"===n.type?n.checked:n.value}),"text"!==n.type||i||n.addEventListener("keydown",function(){setTimeout(function(){t[r]=n.value},0)})},updated:function(e){var t=e.element,n=e.attributeValue;t["checkbox"===t.type?"checked":"value"]=this[n]}}),t("class",function(e){var t=e.element,n=e.argument,r=e.attributeValue;this.$on(r||n,function(e){t.classList[e?"add":"remove"](n||r);var i=t.getAttribute("class");null===i||i.length||t.removeAttribute("class")},{immediate:!0,node:t,type:"d"})},{argumentIsRequired:!0}),t("style",function(e){var t=e.element,n=e.argument,r=e.attributeValue;n=a(n);var i="opacity, z-index, font-weight, line-height".split(", ");this.$on(r||n,function(e){isNaN(+e)||i.includes(n)||(e+="px"),t.style[n]=e},{node:t,type:"d",immediate:!0})},{argumentIsRequired:!0});var c=function(e,t){if("string"==typeof e)this.$el=document.querySelector(e);else{if(!(e instanceof HTMLElement))throw new TypeError('wrong selector or element: expected element or string, got "'+String(e)+'"');this.$el=e}this.$events=[],this.$formatters={},this.$_proxy=null,this.$extendWith(t.state||{},t.actions||{},t.computed||{},t.formatters||{}),s(this.$el).forEach(this.$interpolation,this),this.$el.querySelectorAll("*").forEach(this.$execDirectives,this),this.$observe()};return c.prototype.$extendWith=function(e,t,n,r){var i=this;this.$makeProxy(e);var o=function(e){Object.defineProperty(i,e,{get:function(){return i.$_proxy[e]},set:function(t){i.$_proxy[e]=t}})};for(var a in e)o(a);for(var s in t)i[s]=t[s].bind(i);for(var u in n)Object.defineProperty(i,u,{get:n[u].bind(i),set:function(){return!1}});for(var c in r)i.$formatters[c]=r[c].bind(i)},c.prototype.$makeProxy=function(e){var t=this;this.$_proxy=new Proxy(e,{get:function(e,t){if(!e.hasOwnProperty(t))throw new Error('unknown state property "'+t+'"');return e[t]},set:function(e,n,r){if(!e.hasOwnProperty(n))throw new Error('unknown state property "'+n+'"');if(r!==e[n])return e[n]=r,t.$emit(n),t.$emit(),!0},deleteProperty:function(){return!1}})},c.prototype.$pipeFormatters=function(e){return function(e,t){return e.length?e.map(function(e){if(e in t)return t[e];throw new Error('formatter "'+e+'" not found')}).reduce(function(e,t){return function(n){return t(e(n))}}):function(e){return e}}(e,this.$formatters).bind(this)},c.prototype.$execDirectives=function(e){var t=this;!function(e,t){if(e.attributes.length)for(var r=0,i=u(e);r<i.length;r+=1){var a=i[r];if(!n.hasOwnProperty(a.name))throw new o('directive "'+a.name+'" not found',e);var s=n[a.name],c=s.options,f=s.callback;if(c.argumentIsRequired&&!a.arg)throw new o("directive needs an arguments, but there's nothing",e);return t(f,{element:e,attributeValue:e.getAttribute(""+a),modifiers:a.modifiers,argument:a.arg})}}(e,function(n,r){"function"==typeof n?n.call(t,r):("ready"in n&&n.ready.call(t,r),"updated"in n&&t.$on("",function(){n.updated.call(t,r)},{type:"d",node:e}))})},c.prototype.$interpolation=function(e){var t=this;!function(e,t){var n=/#\[( ?)\w+(?: \w+)*\1\]/gi,r=e.textContent;if(n.test(r)){var i=[];r.replace(n,function(e,t,n){return i.push({string:e,startIndex:n}),e});for(var o=0,a=i;o<a.length;o+=1){var s=a[o],u=s.string,c=s.startIndex,f=u.replace(/^#\[ ?/,"").replace(/ ?\]$/,"").split(" "),l=f[0];return t({initialText:r,node:e,formatters:f.slice(1),match:{startIndex:c,string:u},propertyName:l})}}}(e,function(e){var n=e.initialText,r=e.node,i=e.propertyName,o=e.formatters,a=e.match,s=a.startIndex,u=a.string,c=t.$pipeFormatters(o);t.$on(i,function(e){e=String(c(e));var t=n.slice(0,s)+e+n.slice(s+u.length+e.length,n.length);n!==t&&(r.textContent=t)},{immediate:!0,type:"i",node:r})})},c.prototype.$observe=function(){var e,t,n,r=this,i=function(e,t){void 0===t&&(t="i");for(var n=r.$events.filter(function(n){return n.type===t&&n.node===e}).map(function(e,t){return t}),i=0,o=n;i<o.length;i+=1){var a=o[i];r.$events.splice(a,1)}};(e={textAdded:this.$interpolation.bind(this),elementAdded:this.$execDirectives.bind(this),textRemoved:i,elementRemoved:function(e){i(e,"d")}},t=Node.TEXT_NODE,n=Node.ELEMENT_NODE,new MutationObserver(function(r){for(var i=0,o=r;i<o.length;i+=1){for(var a=o[i],u=0,c=a.addedNodes;u<c.length;u+=1){var f=c[u];if(f.nodeType===t){if("childList"===a.type&&a.target.hasChildNodes(f))continue;e.textAdded(f)}else f.nodeType===n&&(s(f).forEach(function(t){return e.textAdded(t)}),e.elementAdded(f))}for(var l=0,d=a.removedNodes;l<d.length;l+=1){var p=d[l];p.nodeType===t?e.textRemoved(p):p.nodeType===n&&(s(p).forEach(function(t){return e.textRemoved(t)}),e.elementRemoved(p))}}})).observe(this.$el,{childList:!0,subtree:!0})},c.prototype.$on=function(e,t,n){var r=n.type,i=n.node,o=n.immediate;void 0===o&&(o=!1),this.$events.push(Object.assign({},{prop:e,fn:t},r?{type:r}:{},i?{node:i}:{})),o&&this.$emit(e)},c.prototype.$emit=function(e){var t=this;this.$events.filter(function(t){return!e||t.prop===e}).forEach(function(e){var n=e.prop?[t[e.prop]]:[];e.fn.apply(t,n)})},c.directive=t,c}();
